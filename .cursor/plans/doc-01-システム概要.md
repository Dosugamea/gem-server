---
name: タスク01 - システム概要
overview: 仮想通貨管理サービスのシステム概要を定義します
---

# タスク01: システム概要

## 1.1 目的

Webサイト・ゲーム内専用の仮想通貨を管理するマイクロサービス。**PaymentRequest APIのプロバイダー側（決済アプリ側）**として機能し、`https://yourdomain.com/pay` という決済方法を提供します。マーチャントサイトはこの決済方法を `supportedMethods` に指定することで、ユーザーが保有する仮想通貨を使ってデジタル商品（ゲーム内アイテム、コンテンツなど）を購入できるようになります。

## 1.2 主要機能

- **PaymentRequest APIプロバイダー**: `https://yourdomain.com/pay` という決済方法を提供
- **Payment Handler実装**: Service Workerと決済アプリウィンドウによる決済処理
- **通貨管理**: 有償通貨（Paid Currency）と無償通貨（Free Currency）の2種類を管理
- **決済処理**: ユーザーが保有する仮想通貨を使ってデジタル商品を購入する際の決済処理
- **付与**: 無償通貨の配布、その他の方法による通貨の付与
- **消費**: 保有している通貨の使用（決済時の消費を含む）
- **コード引き換え**: プロモーションコードやギフトコードを引き換えて通貨を加算
- **補填**: 問題があった際の補填処理
- **失効**: アカウントBANなどによる通貨の失効
- **返金**: 決済返金時の有償通貨回収
- **履歴管理**: 全取引履歴の記録と過去状態の遡及

## 1.3 技術スタック

- **バックエンド**: Golang (Echo Framework + gRPC)
- **データベース**: MySQL
- **Payment Handler**: Service Worker + 決済アプリウィンドウ（JavaScript）
- **認証**: JWT トークンベース認証
- **可観測性**: OpenTelemetry (トレーシング、メトリクス、ログ)
- **API仕様**: OpenAPI 3.0 (Swagger/Redoc)
